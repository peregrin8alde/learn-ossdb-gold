---
title: "Getting Started in Docker"
linkTitle: "Getting Started in Docker"
weight: 2
description: >
  Getting Started in Docker
---
= Getting Started in Docker

参考 : https://hub.docker.com/_/postgres[PostgreSQL の Docker イメージ]

== システム構成

サーバ
クライアント

== ネットワーク

.実行コマンド
[source,shell]
----
docker network create postgres_getstarted_nw
----

.実行結果
[%collapsible]
====
[source,shell]
------
02369c82c2c732449d2eaa8cbbdeaf48daf12cb687be8560abe72fc1d5d8a5d7
------
====

.実行コマンド
[source,shell]
----
docker network ls | grep postgres_getstarted_nw
----

.実行結果
[%collapsible]
====
[source,shell]
------
02369c82c2c7   postgres_getstarted_nw    bridge    local
------
====


== ディスク

.実行コマンド
[source,shell]
----
docker volume create postgres_getstarted_vl
----

.実行結果
[%collapsible]
====
[source,shell]
------
postgres_getstarted_vl
------
====


.実行コマンド
[source,shell]
----
docker volume ls | grep postgres_getstarted_vl
----

.実行結果
[%collapsible]
====
[source,shell]
------
local     postgres_getstarted_vl
------
====


== インストール

PostgreSQL バージョン : 14 （ OSSDB-Gold Ver.3.0 向け）

.実行コマンド
[source,shell]
----
docker pull postgres:14
----

.実行結果
[%collapsible]
====
[source,shell]
------
14: Pulling from library/postgres
～略～
Status: Downloaded newer image for postgres:14
docker.io/library/postgres:14
------
====

== 初期化 / 起動

起動時に初期化シェルが実行される。

.実行コマンド
[source,shell]
----
docker run \
  -d \
  --name postgres_getstarted_sv \
  -v postgres_getstarted_vl:/var/lib/postgresql/data/pgdata \
  --network postgres_getstarted_nw \
  -e PGDATA=/var/lib/postgresql/data/pgdata \
  -e POSTGRES_PASSWORD=mysecretpassword \
  postgres:14
----

.実行結果
[%collapsible]
====
[source,shell]
------
2712e204c3f0e5b6f74f6dfd1ec76f70960c81ace260796c39403f95b88f6e66
------
====


== 状態確認

== クライアントからの接続

.実行コマンド
[source,shell]
----
docker run \
  -it \
  --rm \
  --name postgres_getstarted_cl \
  --network postgres_getstarted_nw \
  postgres:14 \
    psql -h postgres_getstarted_sv -U postgres
----

* サーバ起動時に `-e POSTGRES_PASSWORD=` で指定した値 `mysecretpassword` をパスワードとして利用
* 終了時は入力待ち表示  ```postgres=# ``` に対して `\q`

.実行結果
[%collapsible]
====
[source,shell]
------
Password for user postgres: 
psql (14.7 (Debian 14.7-1.pgdg110+1))
Type "help" for help.

postgres=# 
------
====

== サンプル SQL 実行

DB 作成

.実行コマンド
[source,shell]
----
docker run \
  -it \
  --rm \
  --name postgres_getstarted_cl \
  --network postgres_getstarted_nw \
  postgres:14 \
    createdb -h postgres_getstarted_sv -U postgres getstarted_db
----

.実行結果
[%collapsible]
====
[source,shell]
------
Password: 
------
====


DB 接続

.実行コマンド
[source,shell]
----
docker run \
  -it \
  --rm \
  --name postgres_getstarted_cl \
  --network postgres_getstarted_nw \
  postgres:14 \
    psql -h postgres_getstarted_sv -U postgres -d getstarted_db
----

.実行結果
[%collapsible]
====
[source,shell]
------
Password for user postgres: 
psql (14.7 (Debian 14.7-1.pgdg110+1))
Type "help" for help.

getstarted_db=# 
------
====

テーブル作成

.実行 SQL
[source, sql]
----
CREATE TABLE weather (
    city            varchar(80),
    temp_lo         int,           -- low temperature
    temp_hi         int,           -- high temperature
    prcp            real,          -- precipitation
    date            date
);
----

.実行結果
[%collapsible]
====
[source, sql]
------
CREATE TABLE
------
====


データ挿入
データ参照
データ更新
データ削除

== 廃止

テーブル削除
DB 削除

停止

資源削除



